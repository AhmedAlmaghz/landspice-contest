# 🛠️ خطوات التطبيق المرتبة والمنظمة

**التاريخ:** 2025-10-23  
**الحالة:** 📋 **خطة تفصيلية خطوة بخطوة**

---

## 🎯 المرحلة الأولى: التنظيف والإصلاح الأساسي

### الخطوة 1: حذف الملفات المكررة
```
حذف:
- src/app/company/ (المجلد القديم)
- src/app/api/v1/companies/[slug]/ (المسار المكرر)

الاحتفاظ بـ:
- src/app/[companyId]/ (الصحيح)
- src/app/api/companies/[companyId]/ (الصحيح)
```

### الخطوة 2: توحيد مسارات الـ APIs
```
الشركات:
✅ POST /api/v1/companies/register
✅ GET /api/companies/[companyId]

المسابقات:
✅ GET /api/v1/contests
✅ POST /api/v1/contests/[contestId]/subscribe

المشاركين:
✅ POST /api/v1/participants/register
```

### الخطوة 3: اختبار الخادم
```bash
npm run dev
# التحقق من عدم وجود أخطاء build
```

---

## 🎯 المرحلة الثانية: نظام التسجيل والدخول

### الخطوة 4: إصلاح API تسجيل الشركات
```
الملف: src/app/api/v1/companies/register/route.ts

المطلوب:
1. التحقق من البيانات المدخلة
2. التحقق من عدم تكرار البريد أو الاسم
3. إنشاء الشركة في قاعدة البيانات
4. توليد كلمة مرور عشوائية
5. إرجاع بيانات الشركة والمسؤول

الاختبار:
POST /api/v1/companies/register
{
  "name": "شركة جديدة",
  "email": "company@example.com",
  "phone": "+966501234567",
  "subscription_plan": "pro"
}
```

### الخطوة 5: إصلاح API تسجيل المشاركين
```
الملف: src/app/api/v1/participants/register/route.ts

المطلوب:
1. التحقق من البيانات المدخلة
2. التحقق من عدم تكرار البريد
3. إنشاء المشارك في قاعدة البيانات
4. الاشتراك في جميع المسابقات تلقائياً
5. توليد كود إحالة فريد
6. إرجاع بيانات المشارك

الاختبار:
POST /api/v1/participants/register
{
  "name": "أحمد محمد",
  "email": "participant@example.com",
  "phone": "+966501234567",
  "city": "الرياض"
}
```

### الخطوة 6: إنشاء نظام الدخول
```
الملف: src/app/api/auth/login/route.ts

المطلوب:
1. التحقق من البريد وكلمة المرور
2. البحث عن المستخدم في قاعدة البيانات
3. التحقق من كلمة المرور
4. إنشاء جلسة (session)
5. إرجاع بيانات المستخدم والدور

الاختبار:
POST /api/auth/login
{
  "email": "admin@landspice.com",
  "password": "admin123"
}
```

### الخطوة 7: اختبار التسجيل والدخول
```
1. تسجيل شركة جديدة
2. تسجيل مشارك جديد
3. تسجيل دخول الإدارة
4. التحقق من حفظ البيانات في قاعدة البيانات
```

---

## 🎯 المرحلة الثالثة: لوحات التحكم الأساسية

### الخطوة 8: إنشاء لوحة الإدارة الرئيسية
```
الملف: src/app/admin/page.tsx

المحتوى:
1. ترحيب بمسؤول النظام
2. عرض الإحصائيات الأساسية:
   - عدد الشركات
   - عدد المسابقات
   - عدد المشاركين
   - عدد الفائزين
3. روابط سريعة:
   - إدارة الشركات
   - إدارة المسابقات
   - إدارة الشبكات

الحماية:
- التحقق من دور المستخدم (Super Admin)
- إعادة توجيه إذا لم يكن مصرح
```

### الخطوة 9: إنشاء صفحة إدارة الشركات
```
الملف: src/app/admin/companies/page.tsx

المحتوى:
1. جدول بجميع الشركات
2. الأعمدة:
   - الاسم
   - البريد
   - الهاتف
   - الخطة
   - عدد المسابقات
   - التاريخ
3. الإجراءات:
   - عرض التفاصيل
   - تعديل
   - حذف

الحماية:
- التحقق من دور المستخدم (Super Admin)
```

### الخطوة 10: إنشاء صفحة إدارة المسابقات
```
الملف: src/app/admin/contests/page.tsx

المحتوى:
1. جدول بجميع المسابقات
2. الأعمدة:
   - العنوان
   - الشركة
   - الحالة
   - عدد المشاركين
   - تاريخ الانتهاء
3. الإجراءات:
   - عرض التفاصيل
   - تعديل
   - حذف

الحماية:
- التحقق من دور المستخدم (Super Admin)
```

### الخطوة 11: إنشاء لوحة الشركة
```
الملف: src/app/company/dashboard/page.tsx

المحتوى:
1. ترحيب بمسؤول الشركة
2. عرض الإحصائيات:
   - عدد المسابقات
   - عدد المشاركين
   - عدد الفائزين
3. روابط سريعة:
   - إنشاء مسابقة جديدة
   - إدارة المسابقات
   - عرض المشاركين

الحماية:
- التحقق من دور المستخدم (Company Admin)
```

### الخطوة 12: إنشاء لوحة المشارك
```
الملف: src/app/participant/dashboard/page.tsx

المحتوى:
1. ترحيب بالمشارك
2. عرض الإحصائيات:
   - عدد المسابقات المشترك فيها
   - التقدم الإجمالي
   - عدد الإحالات
3. روابط سريعة:
   - عرض المسابقات
   - عرض الملف الشخصي
   - عرض الإحالات

الحماية:
- التحقق من دور المستخدم (Participant)
```

---

## 🎯 المرحلة الرابعة: الصفحات العامة

### الخطوة 13: تحسين صفحة الشركة العامة
```
الملف: src/app/[companyId]/page.tsx

المحتوى:
1. بيانات الشركة
2. تبويبات:
   - المسابقات (عرض جميع مسابقات الشركة)
   - الفائزون (عرض الفائزين)
3. أزرار:
   - الاشتراك في المسابقات
   - المتابعة
   - المشاركة

الاختبار:
- http://localhost:3000/1
- http://localhost:3000/2
```

### الخطوة 14: تحسين صفحة تفاصيل المسابقة
```
الملف: src/app/contest/[contestId]/page.tsx

المحتوى:
1. عنوان وصف المسابقة
2. الجوائز والشروط
3. المنصات الاجتماعية (روابط مباشرة)
4. نموذج الاشتراك
5. معلومات الشركة

الاختبار:
- http://localhost:3000/contest/1
- http://localhost:3000/contest/2
```

---

## 🎯 المرحلة الخامسة: الملاحة والروابط

### الخطوة 15: إضافة جميع الروابط في Footer
```
الملف: src/components/Footer.tsx

الروابط:
1. روابط سريعة (6 روابط)
2. روابط الإدارة (3 روابط)
3. روابط الشركة (6 روابط)
4. روابط المشارك (4 روابط)

المجموع: 19 رابط
```

### الخطوة 16: إضافة Navigation Header
```
الملف: src/components/Navigation.tsx

المحتوى:
1. شعار التطبيق
2. قائمة ملاحة ديناميكية
3. بيانات المستخدم
4. زر تسجيل الخروج
5. دعم الهاتف المحمول
```

### الخطوة 17: إضافة Breadcrumb
```
الملف: src/components/Breadcrumb.tsx

المحتوى:
1. عرض المسار الحالي
2. روابط للعودة للصفحات السابقة
3. تحديث تلقائي حسب الصفحة
```

### الخطوة 18: إضافة ProtectedRoute
```
الملف: src/components/ProtectedRoute.tsx

المحتوى:
1. التحقق من الدور المطلوب
2. التحقق من الصلاحيات
3. إعادة توجيه تلقائي
4. عرض رسالة خطأ
```

---

## 🎯 المرحلة السادسة: الاختبار والتحسين

### الخطوة 19: اختبار شامل
```
1. اختبار التسجيل والدخول
2. اختبار لوحات التحكم
3. اختبار الصفحات العامة
4. اختبار الملاحة
5. اختبار الروابط
6. اختبار الأمان والصلاحيات
```

### الخطوة 20: إصلاح الأخطاء
```
1. تصحيح أي أخطاء في الوظائف
2. تحسين الأداء
3. تحسين الواجهة
4. إضافة رسائل خطأ واضحة
```

### الخطوة 21: التوثيق الكامل
```
1. توثيق جميع الـ APIs
2. توثيق جميع الصفحات
3. توثيق جميع المكونات
4. توثيق نظام الأدوار والصلاحيات
```

---

## ✅ قائمة التحقق النهائية

### التسجيل والدخول
- [ ] تسجيل الشركات يعمل بشكل صحيح
- [ ] تسجيل المشاركين يعمل بشكل صحيح
- [ ] تسجيل دخول الإدارة يعمل بشكل صحيح
- [ ] البيانات تُحفظ في قاعدة البيانات

### لوحات التحكم
- [ ] لوحة الإدارة تعمل بشكل صحيح
- [ ] لوحة الشركة تعمل بشكل صحيح
- [ ] لوحة المشارك تعمل بشكل صحيح
- [ ] الإحصائيات تُعرض بشكل صحيح

### الصفحات العامة
- [ ] صفحة الشركة تعمل بشكل صحيح
- [ ] صفحة المسابقة تعمل بشكل صحيح
- [ ] الاشتراك يعمل بشكل صحيح

### الملاحة والروابط
- [ ] جميع الروابط تعمل بشكل صحيح
- [ ] الملاحة سلسة وسهلة
- [ ] الأمان والصلاحيات تعمل بشكل صحيح

---

## 🚀 الخطوات التالية الفورية

```
1. ✅ إنشاء الخطة الشاملة (مكتمل)
2. ⏳ حذف الملفات المكررة
3. ⏳ توحيد مسارات الـ APIs
4. ⏳ إصلاح API التسجيل
5. ⏳ إنشاء نظام الدخول
6. ⏳ إنشاء لوحات التحكم
7. ⏳ اختبار شامل
```

---

**🎯 نتبع هذه الخطوات بدقة دون عشوائية! 🚀**
